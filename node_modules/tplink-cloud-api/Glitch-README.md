Welcome to the "TP-Link Cloud API" Glitch demo app
==================================================

You can use if with Maker from IFTTT for example to control multiple plugs and/or bulbs in a same call (similar to a Kasa scene).

Remix this app to use it yourself.

1. Edit the thre variables in .env file:

  TPLINK_USER=your TPlink username

  TPLINK_PASS=your TPlink password

  TPLINK_TERM=get an [UUIDv4](https://www.uuidgenerator.net/)

2. Edit the server.js and customize what you want to do when the app receive a POST:

For example you can toggle a plug:

await myTPLink.getHS100("My Smart Plug").toggle()

. replace "My Smart Plug" by the Name you gave to your plug in the Kasa app (give a different name to each plug!)
. instead of toggle(), you can use powerOn() or powerOff()

If you want to trigger multiple plugs, you can do it like this:

await myTPLink.getHS100("My Smart Plug").toggle();
await myTPLink.getHS100("My Smart Plug 2").powerOn();
await myTPLink.getHS100("My Smart Plug 3").powerOff();
await myTPLink.getHS100("My Smart Plug 4").powerOff();

If you have an LB100/110/120, you can change it's state with:

await myTPLink.getLB100("Bedroom LB120").transition_light_state(1, 90)

the two parameters are:
on_off: 1 on, 0 on_off
brightness: 0-100

Finally if you have an LB130, use this:

// For LB130:
 //   on_off: 1 on, 0 on_off
 //   brightness: 0-100
 //   hue: 0-360           See HSB in http://colorizer.org/
 //   saturation: 0-100

 // await myTPLink.getLB130("Kitchen LB130").transition_light_state(1, 90, 150, 80);


You can also create multiple blocks like this:

app.post('/scene1', async function(request, response){
  ...
}

app.post('/scene2', async function(request, response){
  ...
}

That you can then call with a POST request to you glitch app http://myapp.glitch.me/scene1
http://myapp.glitch.me/scene2
...
